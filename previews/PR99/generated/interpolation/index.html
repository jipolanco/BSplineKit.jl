<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spline interpolations · BSplineKit.jl</title><meta name="title" content="Spline interpolations · BSplineKit.jl"/><meta property="og:title" content="Spline interpolations · BSplineKit.jl"/><meta property="twitter:title" content="Spline interpolations · BSplineKit.jl"/><meta name="description" content="Documentation for BSplineKit.jl."/><meta property="og:description" content="Documentation for BSplineKit.jl."/><meta property="twitter:description" content="Documentation for BSplineKit.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="../../assets/tomate.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BSplineKit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Spline interpolations</a><ul class="internal"><li><a class="tocitem" href="#Interpolating-data"><span>Interpolating data</span></a></li><li><a class="tocitem" href="#Natural-splines"><span>Natural splines</span></a></li><li><a class="tocitem" href="#extrapolation-example"><span>Extrapolations</span></a></li></ul></li><li><a class="tocitem" href="../approximation/">Function approximation</a></li><li><a class="tocitem" href="../heat/">Heat equation</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../bsplines/">B-splines</a></li><li><a class="tocitem" href="../../splines/">Splines</a></li><li><a class="tocitem" href="../../interpolation/">Data interpolation</a></li><li><a class="tocitem" href="../../extrapolation/">Extrapolation</a></li><li><a class="tocitem" href="../../approximation/">Function approximation</a></li><li><a class="tocitem" href="../../recombination/">Basis recombination</a></li><li><a class="tocitem" href="../../tensors/">Banded tensors</a></li><li><a class="tocitem" href="../../galerkin/">Galerkin tools</a></li><li><a class="tocitem" href="../../collocation/">Collocation tools</a></li><li><a class="tocitem" href="../../boundary_conditions/">Boundary conditions</a></li><li><input class="collapse-toggle" id="menuitem-3-11" type="checkbox"/><label class="tocitem" for="menuitem-3-11"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../diffops/">Differential operators</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Spline interpolations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spline interpolations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jipolanco/BSplineKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jipolanco/BSplineKit.jl/blob/master/examples/interpolation.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="interpolation-example"><a class="docs-heading-anchor" href="#interpolation-example">Spline interpolations</a><a id="interpolation-example-1"></a><a class="docs-heading-anchor-permalink" href="#interpolation-example" title="Permalink"></a></h1><h2 id="Interpolating-data"><a class="docs-heading-anchor" href="#Interpolating-data">Interpolating data</a><a id="Interpolating-data-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolating-data" title="Permalink"></a></h2><p>BSplineKit can interpolate evenly and unevenly-distributed data.</p><p>For example, we can try interpolating random data on randomly-distributed data points:</p><pre><code class="language-julia hljs">using Random
rng = MersenneTwister(42)

Ndata = 20
xs = range(0, 1; length = Ndata) .+ 0.01 .* randn(rng, Ndata)
sort!(xs)  # make sure coordinates are sorted
xs[begin] = 0; xs[end] = 1;   # not strictly necessary; just to set the data limits
ys = sinpi.(xs) .+ 0.02 .* randn(rng, Ndata);</code></pre><p>Let&#39;s start by plotting the generated data:</p><pre><code class="language-julia hljs">using CairoMakie
scatter(xs, ys; label = &quot;Data&quot;, color = :black)</code></pre><img src="e4924af5.svg" alt="Example block output"/><p>To interpolate the data using splines, we may choose any arbitrary B-spline order <span>$k$</span> (in particular, <span>$k = 4$</span> corresponds to cubic splines). The main interpolation function is <a href="../../interpolation/#BSplineKit.SplineInterpolations.interpolate"><code>interpolate</code></a>.</p><pre><code class="language-julia hljs">using BSplineKit
S = interpolate(xs, ys, BSplineOrder(4))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SplineInterpolation containing the 20-element Spline{Float64}:
 basis: 20-element BSplineBasis of order 4, domain [0.0, 1.0]
 order: 4
 knots: [0.0, 0.0, 0.0, 0.0, 0.107311, 0.159983, 0.213316, 0.268371, 0.321046, 0.36973  …  0.625816, 0.681882, 0.732199, 0.783289, 0.837281, 0.886254, 1.0, 1.0, 1.0, 1.0]
 coefficients: [0.0183804, 0.15391, 0.315331, 0.496405, 0.598167, 0.712468, 0.930592, 0.875045, 0.990095, 1.00157, 0.981121, 1.0346, 0.933992, 0.850968, 0.735805, 0.666223, 0.459099, 0.407906, -0.123718, -0.0129226]
 interpolation points: [0.0, 0.0518416, 0.109298, 0.160794, 0.209856, 0.269298, 0.325959, 0.367882, 0.415349, 0.465107, 0.524201, 0.570411, 0.635975, 0.671061, 0.738611, 0.786926, 0.824332, 0.900587, 0.933845, 1.0]
</code></pre><p>Let&#39;s plot the result:</p><pre><code class="language-julia hljs">lines!(0..1, S; label = &quot;k = 4&quot;, color = Cycled(4 - 3))</code></pre><img src="0c1f0ac4.svg" alt="Example block output"/><p>We can also choose other interpolation orders for comparison:</p><pre><code class="language-julia hljs">for k ∈ (5, 6, 8)
    S = interpolate(xs, ys, BSplineOrder(k))
    lines!(0..1, S; label = &quot;k = $k&quot;, color = Cycled(k - 3))
end
axislegend()</code></pre><img src="944823c3.svg" alt="Example block output"/><p>We see larger and larger oscillations, especially near the boundaries, as the spline order increases. We can try to fix this using <strong>natural</strong> splines, which impose some derivatives to be zero at the boundaries.</p><h2 id="Natural-splines"><a class="docs-heading-anchor" href="#Natural-splines">Natural splines</a><a id="Natural-splines-1"></a><a class="docs-heading-anchor-permalink" href="#Natural-splines" title="Permalink"></a></h2><p><a href="https://en.wikipedia.org/wiki/Spline_(mathematics)#Examples">Natural splines</a> usually refer to cubic splines (order <span>$k = 4$</span>) with the additional constraint <span>$S&#39;&#39;(a) = S&#39;&#39;(b) = 0$</span> at the boundaries (<span>$x ∈ \{a, b\}$</span>).</p><p>In BSplineKit, this concept is generalised for all even spline orders <span>$k$</span>, by setting all derivatives of order <span>$2, 3, …, k / 2$</span> to be zero at the boundaries. For instance, for <span>$k = 6$</span> (quintic splines), the constraint is <span>$S&#39;&#39; = S&#39;&#39;&#39; = 0$</span>. We achieve this by using <a href="../../recombination/#basis-recombination-api">basis recombination</a> to implicitly impose the wanted boundary conditions.</p><p>The natural boundary condition not only allows to suppress oscillations near the boundaries, but is also quite convenient for interpolations, as it reduces the number of degrees of freedom such that the number of unique spline knots is equal to the number of data points. This simply means that one can set the knots to be equal to the data points. All of this is done internally when using this boundary condition.</p><p>To impose natural boundary conditions, one just needs to pass <a href="../../boundary_conditions/#BSplineKit.BoundaryConditions.Natural"><code>Natural</code></a> to <code>interpolate</code>, as illustrated below.</p><pre><code class="language-julia hljs">k = 8
S = interpolate(xs, ys, BSplineOrder(k))  # without BCs
Snat = interpolate(xs, ys, BSplineOrder(k), Natural())  # with natural BCs</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SplineInterpolation containing the 20-element Spline{Float64}:
 basis: 20-element RecombinedBSplineBasis of order 8, domain [0.0, 1.0], BCs {left =&gt; (D{2}, D{3}, D{4}), right =&gt; (D{2}, D{3}, D{4})}
 order: 8
 knots: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0518416, 0.109298  …  0.900587, 0.933845, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
 coefficients: [0.0137583, 0.142842, 0.381383, 0.482671, 0.653978, 0.576594, 1.10858, 0.718314, 1.09114, 0.975321, 0.940988, 1.12046, 0.863254, 0.931811, 0.613254, 0.83853, 0.206394, 0.679701, 0.046989, -0.0095833]
 interpolation points: [0.0, 0.0518416, 0.109298, 0.160794, 0.209856, 0.269298, 0.325959, 0.367882, 0.415349, 0.465107, 0.524201, 0.570411, 0.635975, 0.671061, 0.738611, 0.786926, 0.824332, 0.900587, 0.933845, 1.0]
</code></pre><p>Let&#39;s look at the result:</p><pre><code class="language-julia hljs">scatter(xs, ys; label = &quot;Data&quot;, color = :black)
lines!(0..1, S; label = &quot;k = $k (original)&quot;, linewidth = 2)
lines!(0..1, Snat; label = &quot;k = $k (natural)&quot;, linestyle = :dash, linewidth = 4)
axislegend()</code></pre><img src="acc62c87.svg" alt="Example block output"/><p>Clearly, the spurious oscillations are strongly suppressed near the boundaries.</p><h2 id="extrapolation-example"><a class="docs-heading-anchor" href="#extrapolation-example">Extrapolations</a><a id="extrapolation-example-1"></a><a class="docs-heading-anchor-permalink" href="#extrapolation-example" title="Permalink"></a></h2><p>One can use extrapolation to evaluate splines outside of their domain of definition. A few different extrapolation strategies are implemented in BSplineKit. See <a href="../../extrapolation/#Extrapolation-methods">Extrapolation methods</a> for details.</p><p>Below we compare a few possible extrapolation strategies included in BSplineKit.</p><p>First, we generate and interpolate new data:</p><pre><code class="language-julia hljs">xs = 0.2:0.2:1.2
ys = 2 * cospi.(xs)
S = interpolate(xs, ys, BSplineOrder(4))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SplineInterpolation containing the 6-element Spline{Float64}:
 basis: 6-element BSplineBasis of order 4, domain [0.2, 1.2]
 order: 4
 knots: [0.2, 0.2, 0.2, 0.2, 0.6, 0.8, 1.2, 1.2, 1.2, 1.2]
 coefficients: [1.61803, 1.13682, -0.301508, -2.08779, -2.14709, -1.61803]
 interpolation points: 0.2:0.2:1.2
</code></pre><p>One can directly evaluate these interpolations outside of the domain <span>$[0, 1]$</span>, but the result will always be zero:</p><pre><code class="language-julia hljs">S(-0.32)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>To enable extrapolations, one must call <a href="../../extrapolation/#BSplineKit.SplineExtrapolations.extrapolate"><code>extrapolate</code></a> with the desired extrapolation strategy (see <a href="../../extrapolation/#Extrapolation-methods">Extrapolation methods</a> for a list). Here we compare both <a href="../../extrapolation/#BSplineKit.SplineExtrapolations.Flat"><code>Flat</code></a> and <a href="../../extrapolation/#BSplineKit.SplineExtrapolations.Smooth"><code>Smooth</code></a> methods:</p><pre><code class="language-julia hljs">E_flat   = extrapolate(S, Flat())
E_linear = extrapolate(S, Linear())
E_smooth = extrapolate(S, Smooth())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SplineExtrapolation containing the 6-element Spline{Float64}:
 basis: 6-element BSplineBasis of order 4, domain [0.2, 1.2]
 order: 4
 knots: [0.2, 0.2, 0.2, 0.2, 0.6, 0.8, 1.2, 1.2, 1.2, 1.2]
 coefficients: [1.61803, 1.13682, -0.301508, -2.08779, -2.14709, -1.61803]
 extrapolation method: Smooth()</code></pre><pre><code class="language-julia hljs">fig = Figure(size = (600, 400))
ax = Axis(fig[1, 1])
scatter!(ax, xs, ys; label = &quot;Data&quot;, color = :black)
lines!(ax, -0.5..1.5, S; label = &quot;No extrapolation&quot;, linewidth = 2)
lines!(ax, -0.5..1.5, E_smooth; label = &quot;Smooth&quot;, linestyle = :dash, linewidth = 2)
lines!(ax, -0.5..1.5, E_linear; label = &quot;Linear&quot;, linestyle = :dashdot, linewidth = 2)
lines!(ax, -0.5..1.5, E_flat; label = &quot;Flat&quot;, linestyle = :dot, linewidth = 2)
axislegend(ax)
fig</code></pre><img src="eaca6ddc.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../approximation/">Function approximation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 12 November 2024 21:36">Tuesday 12 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
